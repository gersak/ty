{% extends "base.html" %}

{% block title %}Modal Examples - HTMX + Ty Components{% endblock %}

{% block content %}
<div class="min-h-screen py-12">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
        
        <!-- Page Header -->
        <div class="text-center mb-16">
            <h1 class="text-4xl font-bold ty-text-primary-strong mb-4 flex items-center justify-center">
                <ty-icon name="layers" class="mr-4"></ty-icon>
                Modal Integration with HTMX
            </h1>
            <p class="text-lg ty-text-neutral-mild max-w-3xl mx-auto">
                Discover how Ty modal components integrate seamlessly with HTMX for dynamic content loading, 
                server-side validation, and real-time interactions.
            </p>
        </div>

        <!-- Modal Categories -->
        <div class="space-y-16">

            <!-- Basic Modal Examples -->
            <section>
                <h2 class="text-3xl font-bold ty-text-info-strong mb-8 flex items-center">
                    <ty-icon name="window" class="mr-3"></ty-icon>
                    Basic Modal Examples
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <!-- Static Content Modals -->
                    <div class="glass-card">
                        <h3 class="text-lg font-semibold ty-text-neutral-strong mb-4">Static Content</h3>
                        <div class="space-y-3">
                            <ty-button flavor="primary" onclick="document.getElementById('modal-welcome').setAttribute('open', 'true')" class="w-full">
                                <ty-icon name="star" class="mr-2"></ty-icon>
                                Welcome Modal
                            </ty-button>
                            <ty-button flavor="info" onclick="document.getElementById('modal-info').setAttribute('open', 'true')" class="w-full">
                                <ty-icon name="info" class="mr-2"></ty-icon>
                                Info Modal
                            </ty-button>
                            <ty-button flavor="warning" onclick="document.getElementById('modal-confirm').setAttribute('open', 'true')" class="w-full">
                                <ty-icon name="alert-triangle" class="mr-2"></ty-icon>
                                Confirmation
                            </ty-button>
                        </div>
                    </div>

                    <!-- Different Sizes -->
                    <div class="glass-card">
                        <h3 class="text-lg font-semibold ty-text-neutral-strong mb-4">Modal Sizes</h3>
                        <div class="space-y-3">
                            <ty-button flavor="secondary" onclick="document.getElementById('modal-sm').setAttribute('open', 'true')" class="w-full">
                                Small
                            </ty-button>
                            <ty-button flavor="secondary" onclick="document.getElementById('modal-md').setAttribute('open', 'true')" class="w-full">
                                Medium
                            </ty-button>
                            <ty-button flavor="secondary" onclick="document.getElementById('modal-lg').setAttribute('open', 'true')" class="w-full">
                                Large
                            </ty-button>
                            <ty-button flavor="secondary" onclick="document.getElementById('modal-xl').setAttribute('open', 'true')" class="w-full">
                                Extra Large
                            </ty-button>
                        </div>
                    </div>

                    <!-- Different Flavors -->
                    <div class="glass-card">
                        <h3 class="text-lg font-semibold ty-text-neutral-strong mb-4">Modal Flavors</h3>
                        <div class="space-y-3">
                            <ty-button flavor="success" onclick="document.getElementById('modal-success').setAttribute('open', 'true')" class="w-full">
                                <ty-icon name="check-circle" class="mr-2"></ty-icon>
                                Success
                            </ty-button>
                            <ty-button flavor="danger" onclick="document.getElementById('modal-danger').setAttribute('open', 'true')" class="w-full">
                                <ty-icon name="x-circle" class="mr-2"></ty-icon>
                                Danger
                            </ty-button>
                            <ty-button flavor="warning" onclick="document.getElementById('modal-warning-flavor').setAttribute('open', 'true')" class="w-full">
                                <ty-icon name="alert-triangle" class="mr-2"></ty-icon>
                                Warning
                            </ty-button>
                        </div>
                    </div>

                    <!-- Close Behaviors -->
                    <div class="glass-card">
                        <h3 class="text-lg font-semibold ty-text-neutral-strong mb-4">Close Behaviors</h3>
                        <div class="space-y-3">
                            <ty-button flavor="neutral" onclick="document.getElementById('modal-backdrop-close').setAttribute('open', 'true')" class="w-full text-sm">
                                Backdrop Close
                            </ty-button>
                            <ty-button flavor="neutral" onclick="document.getElementById('modal-no-backdrop').setAttribute('open', 'true')" class="w-full text-sm">
                                No Backdrop Close
                            </ty-button>
                            <ty-button flavor="neutral" onclick="document.getElementById('modal-no-escape').setAttribute('open', 'true')" class="w-full text-sm">
                                No Escape Close
                            </ty-button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- HTMX Dynamic Content -->
            <section>
                <h2 class="text-3xl font-bold ty-text-success-strong mb-8 flex items-center">
                    <ty-icon name="zap" class="mr-3"></ty-icon>
                    HTMX Dynamic Content Loading
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- User Profile Modal -->
                    <div class="glass-card">
                        <h3 class="text-lg font-semibold ty-text-neutral-strong mb-4">User Profiles</h3>
                        <p class="ty-text-neutral-mild text-sm mb-4">Click any user to load their profile dynamically</p>
                        <div class="space-y-2">
                            {% for user in users %}
                            <ty-button flavor="primary" 
                                       class="w-full text-left justify-start"
                                       hx-get="/api/modal/content/user-profile?user_id={{ user.id }}"
                                       hx-target="#dynamic-modal-content"
                                       onclick="document.getElementById('dynamic-modal').setAttribute('open', 'true')">
                                <ty-icon name="user" class="mr-2"></ty-icon>
                                {{ user.name }}
                            </ty-button>
                            {% endfor %}
                        </div>
                    </div>

                    <!-- Task Details Modal -->
                    <div class="glass-card">
                        <h3 class="text-lg font-semibold ty-text-neutral-strong mb-4">Task Details</h3>
                        <p class="ty-text-neutral-mild text-sm mb-4">View detailed task information loaded from server</p>
                        <div class="space-y-2">
                            {% for task in tasks %}
                            <ty-button flavor="info" 
                                       class="w-full text-left justify-start"
                                       hx-get="/api/modal/content/task-details?task_id={{ task.id }}"
                                       hx-target="#dynamic-modal-content"
                                       onclick="document.getElementById('dynamic-modal').setAttribute('open', 'true')">
                                <ty-icon name="list" class="mr-2"></ty-icon>
                                {{ task.title }}
                            </ty-button>
                            {% endfor %}
                        </div>
                    </div>

                    <!-- Server Response Examples -->
                    <div class="glass-card">
                        <h3 class="text-lg font-semibold ty-text-neutral-strong mb-4">Server Responses</h3>
                        <p class="ty-text-neutral-mild text-sm mb-4">Different types of server-generated content</p>
                        <div class="space-y-2">
                            <ty-button flavor="success" 
                                       class="w-full"
                                       hx-get="/api/modal/content/weather-report"
                                       hx-target="#dynamic-modal-content"
                                       onclick="document.getElementById('dynamic-modal').setAttribute('open', 'true')">
                                <ty-icon name="cloud" class="mr-2"></ty-icon>
                                Weather Report
                            </ty-button>
                            <ty-button flavor="warning" 
                                       class="w-full"
                                       hx-get="/api/modal/content/system-status"
                                       hx-target="#dynamic-modal-content"
                                       onclick="document.getElementById('dynamic-modal').setAttribute('open', 'true')">
                                <ty-icon name="activity" class="mr-2"></ty-icon>
                                System Status
                            </ty-button>
                            <ty-button flavor="secondary" 
                                       class="w-full"
                                       hx-get="/api/modal/content/random-quote"
                                       hx-target="#dynamic-modal-content"
                                       onclick="document.getElementById('dynamic-modal').setAttribute('open', 'true')">
                                <ty-icon name="message-circle" class="mr-2"></ty-icon>
                                Random Quote
                            </ty-button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- HTMX Form Integration -->
            <section>
                <h2 class="text-3xl font-bold ty-text-warning-strong mb-8 flex items-center">
                    <ty-icon name="edit" class="mr-3"></ty-icon>
                    HTMX Form Integration
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Modal with Form -->
                    <div class="glass-card">
                        <h3 class="text-lg font-semibold ty-text-neutral-strong mb-4">Contact Form Modal</h3>
                        <p class="ty-text-neutral-mild text-sm mb-4">Server-side form validation within modal</p>
                        <ty-button flavor="primary" 
                                   onclick="document.getElementById('form-modal').setAttribute('open', 'true')"
                                   class="w-full">
                            <ty-icon name="mail" class="mr-2"></ty-icon>
                            Open Contact Form
                        </ty-button>
                    </div>

                    <!-- Multi-step Modal -->
                    <div class="glass-card">
                        <h3 class="text-lg font-semibold ty-text-neutral-strong mb-4">Multi-step Process</h3>
                        <p class="ty-text-neutral-mild text-sm mb-4">Server-driven modal flow with multiple steps</p>
                        <ty-button flavor="secondary" 
                                   hx-get="/api/modal/wizard/start"
                                   hx-target="#wizard-modal-content"
                                   onclick="document.getElementById('wizard-modal').setAttribute('open', 'true')"
                                   class="w-full">
                            <ty-icon name="arrow-right" class="mr-2"></ty-icon>
                            Start Wizard
                        </ty-button>
                    </div>
                </div>
            </section>

            <!-- Advanced Modal Features -->
            <section>
                <h2 class="text-3xl font-bold ty-text-danger-strong mb-8 flex items-center">
                    <ty-icon name="settings" class="mr-3"></ty-icon>
                    Advanced Modal Features
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Loading States -->
                    <div class="glass-card">
                        <h3 class="text-lg font-semibold ty-text-neutral-strong mb-4">Loading States</h3>
                        <p class="ty-text-neutral-mild text-sm mb-4">Modals with loading indicators and delays</p>
                        <ty-button flavor="info" 
                                   hx-get="/api/modal/content/slow-loading"
                                   hx-target="#loading-modal-content"
                                   hx-indicator="#loading-spinner"
                                   onclick="document.getElementById('loading-modal').setAttribute('open', 'true')"
                                   class="w-full">
                            <ty-icon name="loader" class="mr-2"></ty-icon>
                            Slow Loading
                        </ty-button>
                    </div>

                    <!-- Error Handling -->
                    <div class="glass-card">
                        <h3 class="text-lg font-semibold ty-text-neutral-strong mb-4">Error Handling</h3>
                        <p class="ty-text-neutral-mild text-sm mb-4">Server error responses in modals</p>
                        <ty-button flavor="danger" 
                                   hx-get="/api/modal/content/error-demo"
                                   hx-target="#error-modal-content"
                                   onclick="document.getElementById('error-modal').setAttribute('open', 'true')"
                                   class="w-full">
                            <ty-icon name="alert-circle" class="mr-2"></ty-icon>
                            Error Demo
                        </ty-button>
                    </div>

                    <!-- Nested Modals -->
                    <div class="glass-card">
                        <h3 class="text-lg font-semibold ty-text-neutral-strong mb-4">Nested Modals</h3>
                        <p class="ty-text-neutral-mild text-sm mb-4">Modals that open other modals</p>
                        <ty-button flavor="secondary" 
                                   onclick="document.getElementById('parent-modal').setAttribute('open', 'true')"
                                   class="w-full">
                            <ty-icon name="layers" class="mr-2"></ty-icon>
                            Parent Modal
                        </ty-button>
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>

<!-- ============ STATIC MODAL DEFINITIONS ============ -->

<!-- Welcome Modal -->
<ty-modal id="modal-welcome" size="md">
    <div class="ty-elevated rounded-xl shadow-xl max-w-md mx-auto">
        <div class="p-8 text-center">
            <div class="mb-6">
                <ty-icon name="star" class="w-16 h-16 mx-auto ty-text-primary mb-4"></ty-icon>
                <h3 class="text-2xl font-bold ty-text-primary-strong mb-2">Welcome to Ty Modals!</h3>
                <p class="ty-text-neutral-mild">
                    This modal demonstrates the basic functionality of Ty modal components with beautiful styling and smooth animations.
                </p>
            </div>
            <div class="flex justify-center space-x-3">
                <ty-button flavor="secondary" onclick="document.getElementById('modal-welcome').removeAttribute('open')">
                    Maybe Later
                </ty-button>
                <ty-button flavor="primary" onclick="document.getElementById('modal-welcome').removeAttribute('open')">
                    <ty-icon name="check" class="mr-2"></ty-icon>
                    Got it!
                </ty-button>
            </div>
        </div>
    </div>
</ty-modal>

<!-- Info Modal -->
<ty-modal id="modal-info" size="md" flavor="info">
    <div class="ty-elevated rounded-xl shadow-xl max-w-md mx-auto">
        <div class="p-8">
            <div class="flex items-start space-x-4 mb-6">
                <ty-icon name="info" class="w-8 h-8 ty-text-info flex-shrink-0 mt-1"></ty-icon>
                <div>
                    <h3 class="text-xl font-semibold ty-text-info-strong mb-2">Information</h3>
                    <p class="ty-text-neutral-mild">
                        This is an informational modal using the info flavor. Notice how the styling automatically 
                        adapts to provide appropriate visual cues for the content type.
                    </p>
                </div>
            </div>
            <div class="flex justify-end">
                <ty-button flavor="info" onclick="document.getElementById('modal-info').removeAttribute('open')">
                    Understood
                </ty-button>
            </div>
        </div>
    </div>
</ty-modal>

<!-- Confirmation Modal -->
<ty-modal id="modal-confirm" size="sm">
    <div class="ty-elevated rounded-xl shadow-xl max-w-sm mx-auto">
        <div class="p-6 text-center">
            <ty-icon name="alert-triangle" class="w-12 h-12 mx-auto mb-4 ty-text-warning"></ty-icon>
            <h3 class="text-lg font-semibold ty-text-neutral-strong mb-2">Confirm Action</h3>
            <p class="ty-text-neutral-mild mb-6">Are you sure you want to proceed? This action cannot be undone.</p>
            <div class="flex justify-center space-x-3">
                <ty-button flavor="secondary" onclick="document.getElementById('modal-confirm').removeAttribute('open')">
                    Cancel
                </ty-button>
                <ty-button flavor="warning" onclick="document.getElementById('modal-confirm').removeAttribute('open')">
                    <ty-icon name="check" class="mr-2"></ty-icon>
                    Confirm
                </ty-button>
            </div>
        </div>
    </div>
</ty-modal>

<!-- Size Examples -->
<ty-modal id="modal-sm" size="sm">
    <div class="ty-elevated rounded-xl shadow-xl max-w-sm mx-auto">
        <div class="p-6 text-center">
            <h3 class="text-lg font-semibold ty-text-neutral-strong mb-2">Small Modal</h3>
            <p class="ty-text-neutral-mild mb-4">Perfect for simple confirmations and quick actions.</p>
            <ty-button flavor="primary" onclick="document.getElementById('modal-sm').removeAttribute('open')">Close</ty-button>
        </div>
    </div>
</ty-modal>

<ty-modal id="modal-md" size="md">
    <div class="ty-elevated rounded-xl shadow-xl max-w-lg mx-auto">
        <div class="p-8">
            <h3 class="text-xl font-semibold ty-text-neutral-strong mb-4">Medium Modal</h3>
            <p class="ty-text-neutral-mild mb-6">
                This medium-sized modal provides balanced space for content without overwhelming the interface.
                It's ideal for forms, detailed information, and moderate amounts of content.
            </p>
            <div class="flex justify-end space-x-3">
                <ty-button flavor="secondary" onclick="document.getElementById('modal-md').removeAttribute('open')">Cancel</ty-button>
                <ty-button flavor="primary" onclick="document.getElementById('modal-md').removeAttribute('open')">OK</ty-button>
            </div>
        </div>
    </div>
</ty-modal>

<ty-modal id="modal-lg" size="lg">
    <div class="ty-elevated rounded-xl shadow-xl max-w-2xl mx-auto">
        <div class="p-8">
            <h3 class="text-2xl font-semibold ty-text-neutral-strong mb-6">Large Modal</h3>
            <div class="space-y-4 mb-8">
                <p class="ty-text-neutral-mild">
                    Large modals accommodate more complex content, detailed forms, or rich media.
                    They provide ample space while maintaining focus and usability.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="ty-bg-primary-soft rounded-lg p-4">
                        <h4 class="font-medium ty-text-primary-strong mb-2">Primary Feature</h4>
                        <p class="text-sm ty-text-neutral-mild">Detailed description of the primary feature or content.</p>
                    </div>
                    <div class="ty-bg-secondary-soft rounded-lg p-4">
                        <h4 class="font-medium ty-text-secondary-strong mb-2">Secondary Feature</h4>
                        <p class="text-sm ty-text-neutral-mild">Additional information or secondary functionality.</p>
                    </div>
                </div>
            </div>
            <div class="flex justify-end space-x-3">
                <ty-button flavor="secondary" onclick="document.getElementById('modal-lg').removeAttribute('open')">Cancel</ty-button>
                <ty-button flavor="primary" onclick="document.getElementById('modal-lg').removeAttribute('open')">Apply</ty-button>
            </div>
        </div>
    </div>
</ty-modal>

<ty-modal id="modal-xl" size="xl">
    <div class="ty-elevated rounded-xl shadow-xl max-w-4xl mx-auto">
        <div class="p-12">
            <h3 class="text-3xl font-semibold ty-text-neutral-strong mb-8">Extra Large Modal</h3>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
                <div>
                    <h4 class="text-xl font-medium ty-text-neutral-strong mb-4">Main Content</h4>
                    <p class="ty-text-neutral-mild mb-6">
                        Extra large modals are perfect for complex interfaces, detailed dashboards, 
                        or comprehensive forms that require significant screen real estate.
                    </p>
                    <div class="space-y-3">
                        <div class="ty-bg-info-soft rounded-lg p-4">
                            <div class="flex items-center space-x-3 mb-2">
                                <ty-icon name="check-circle" class="ty-text-info-strong"></ty-icon>
                                <h5 class="font-medium">Advanced Feature 1</h5>
                            </div>
                            <p class="text-sm ty-text-neutral-mild">Comprehensive functionality with detailed options.</p>
                        </div>
                        <div class="ty-bg-success-soft rounded-lg p-4">
                            <div class="flex items-center space-x-3 mb-2">
                                <ty-icon name="zap" class="ty-text-success-strong"></ty-icon>
                                <h5 class="font-medium">Performance Metrics</h5>
                            </div>
                            <p class="text-sm ty-text-neutral-mild">Real-time data and analytics display.</p>
                        </div>
                    </div>
                </div>
                <div>
                    <h4 class="text-xl font-medium ty-text-neutral-strong mb-4">Configuration</h4>
                    <div class="ty-bg-neutral-soft rounded-lg p-6">
                        <p class="ty-text-neutral-mild mb-4">
                            This section demonstrates how extra large modals can accommodate 
                            complex layouts with multiple sections and rich interactive content.
                        </p>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between">
                                <span class="text-sm font-medium">Option A</span>
                                <ty-button size="sm" flavor="secondary">Configure</ty-button>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm font-medium">Option B</span>
                                <ty-button size="sm" flavor="secondary">Configure</ty-button>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm font-medium">Option C</span>
                                <ty-button size="sm" flavor="secondary">Configure</ty-button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex justify-end space-x-3">
                <ty-button flavor="secondary" onclick="document.getElementById('modal-xl').removeAttribute('open')">Cancel</ty-button>
                <ty-button flavor="primary" onclick="document.getElementById('modal-xl').removeAttribute('open')">Save All Changes</ty-button>
            </div>
        </div>
    </div>
</ty-modal>

<!-- Flavor Examples -->
<ty-modal id="modal-success" size="md" flavor="success">
    <div class="ty-elevated rounded-xl shadow-xl max-w-md mx-auto">
        <div class="p-8 text-center">
            <ty-icon name="check-circle" class="w-16 h-16 mx-auto mb-4 ty-text-success"></ty-icon>
            <h3 class="text-xl font-semibold ty-text-success-strong mb-2">Success!</h3>
            <p class="ty-text-neutral-mild mb-6">
                Your operation completed successfully. This modal uses the success flavor for positive feedback.
            </p>
            <ty-button flavor="success" onclick="document.getElementById('modal-success').removeAttribute('open')">
                <ty-icon name="check" class="mr-2"></ty-icon>
                Great!
            </ty-button>
        </div>
    </div>
</ty-modal>

<ty-modal id="modal-danger" size="md" flavor="danger">
    <div class="ty-elevated rounded-xl shadow-xl max-w-md mx-auto">
        <div class="p-8 text-center">
            <ty-icon name="x-circle" class="w-16 h-16 mx-auto mb-4 ty-text-danger"></ty-icon>
            <h3 class="text-xl font-semibold ty-text-danger-strong mb-2">Error Occurred</h3>
            <p class="ty-text-neutral-mild mb-6">
                Something went wrong with your request. This modal uses the danger flavor for error states.
            </p>
            <div class="flex justify-center space-x-3">
                <ty-button flavor="secondary" onclick="document.getElementById('modal-danger').removeAttribute('open')">
                    Cancel
                </ty-button>
                <ty-button flavor="danger" onclick="document.getElementById('modal-danger').removeAttribute('open')">
                    <ty-icon name="refresh-cw" class="mr-2"></ty-icon>
                    Try Again
                </ty-button>
            </div>
        </div>
    </div>
</ty-modal>

<ty-modal id="modal-warning-flavor" size="md" flavor="warning">
    <div class="ty-elevated rounded-xl shadow-xl max-w-md mx-auto">
        <div class="p-8">
            <div class="flex items-start space-x-4 mb-6">
                <ty-icon name="alert-triangle" class="w-8 h-8 ty-text-warning flex-shrink-0 mt-1"></ty-icon>
                <div>
                    <h3 class="text-xl font-semibold ty-text-warning-strong mb-2">Warning</h3>
                    <p class="ty-text-neutral-mild">
                        This action requires your attention. The warning flavor provides visual cues 
                        for potentially risky or important operations.
                    </p>
                </div>
            </div>
            <div class="flex justify-end space-x-3">
                <ty-button flavor="secondary" onclick="document.getElementById('modal-warning-flavor').removeAttribute('open')">
                    Cancel
                </ty-button>
                <ty-button flavor="warning" onclick="document.getElementById('modal-warning-flavor').removeAttribute('open')">
                    Proceed Anyway
                </ty-button>
            </div>
        </div>
    </div>
</ty-modal>

<!-- Close Behavior Examples -->
<ty-modal id="modal-backdrop-close" size="md" close-on-outside-click="true">
    <div class="ty-elevated rounded-xl shadow-xl max-w-md mx-auto">
        <div class="p-8 text-center">
            <ty-icon name="mouse-pointer" class="w-12 h-12 mx-auto mb-4 ty-text-info"></ty-icon>
            <h3 class="text-lg font-semibold ty-text-neutral-strong mb-2">Click Outside to Close</h3>
            <p class="ty-text-neutral-mild mb-4">
                This modal can be closed by clicking on the backdrop/overlay behind it.
            </p>
            <ty-button flavor="info" onclick="document.getElementById('modal-backdrop-close').removeAttribute('open')">
                Or click here to close
            </ty-button>
        </div>
    </div>
</ty-modal>

<ty-modal id="modal-no-backdrop" size="md" close-on-outside-click="false">
    <div class="ty-elevated rounded-xl shadow-xl max-w-md mx-auto">
        <div class="p-8 text-center">
            <ty-icon name="lock" class="w-12 h-12 mx-auto mb-4 ty-text-warning"></ty-icon>
            <h3 class="text-lg font-semibold ty-text-neutral-strong mb-2">No Backdrop Close</h3>
            <p class="ty-text-neutral-mild mb-4">
                This modal cannot be closed by clicking the backdrop. You must use the button or escape key.
            </p>
            <ty-button flavor="warning" onclick="document.getElementById('modal-no-backdrop').removeAttribute('open')">
                Close Modal
            </ty-button>
        </div>
    </div>
</ty-modal>

<ty-modal id="modal-no-escape" size="md" close-on-escape="false">
    <div class="ty-elevated rounded-xl shadow-xl max-w-md mx-auto">
        <div class="p-8 text-center">
            <ty-icon name="key" class="w-12 h-12 mx-auto mb-4 ty-text-danger"></ty-icon>
            <h3 class="text-lg font-semibold ty-text-neutral-strong mb-2">No Escape Key</h3>
            <p class="ty-text-neutral-mild mb-4">
                This modal cannot be closed with the escape key. You must click the button.
            </p>
            <ty-button flavor="danger" onclick="document.getElementById('modal-no-escape').removeAttribute('open')">
                Close Modal
            </ty-button>
        </div>
    </div>
</ty-modal>

<!-- Dynamic Content Modal -->
<ty-modal id="dynamic-modal" size="lg">
    <div class="ty-elevated rounded-xl shadow-xl max-w-3xl mx-auto">
        <div id="dynamic-modal-content" class="p-8">
            <div class="text-center py-8">
                <ty-icon name="loader" class="w-8 h-8 mx-auto mb-4 ty-text-neutral-mild animate-spin"></ty-icon>
                <p class="ty-text-neutral-mild">Loading content...</p>
            </div>
        </div>
    </div>
</ty-modal>

<!-- Form Modal -->
<ty-modal id="form-modal" size="md" close-on-outside-click="false">
    <div class="ty-elevated rounded-xl shadow-xl max-w-lg mx-auto">
        <div class="p-8">
            <h3 class="text-xl font-semibold ty-text-neutral-strong mb-6">Contact Us</h3>
            <form hx-post="/api/modal/contact/submit" 
                  hx-target="#form-response" 
                  hx-swap="innerHTML"
                  class="space-y-4">
                
                <div>
                    <label class="block text-sm font-medium ty-text-neutral-strong mb-2">Name</label>
                    <ty-input name="name" placeholder="Your full name" required></ty-input>
                </div>
                
                <div>
                    <label class="block text-sm font-medium ty-text-neutral-strong mb-2">Email</label>
                    <ty-input name="email" type="email" placeholder="your@email.com" required></ty-input>
                </div>
                
                <div>
                    <label class="block text-sm font-medium ty-text-neutral-strong mb-2">Message</label>
                    <textarea name="message" 
                              class="w-full p-3 border rounded-md ty-bg-elevated ty-text-neutral-strong ty-border focus:ty-border-primary focus:outline-none"
                              rows="4" 
                              placeholder="Your message..."
                              required></textarea>
                </div>
                
                <div id="form-response" class="min-h-[20px]"></div>
                
                <div class="flex justify-end space-x-3 pt-4">
                    <ty-button flavor="secondary" onclick="document.getElementById('form-modal').removeAttribute('open')">
                        Cancel
                    </ty-button>
                    <ty-button flavor="primary" type="submit">
                        <ty-icon name="send" class="mr-2"></ty-icon>
                        Send Message
                    </ty-button>
                </div>
            </form>
        </div>
    </div>
</ty-modal>

<!-- Wizard Modal -->
<ty-modal id="wizard-modal" size="lg" close-on-outside-click="false">
    <div class="ty-elevated rounded-xl shadow-xl max-w-3xl mx-auto">
        <div id="wizard-modal-content" class="p-8">
            <div class="text-center py-8">
                <ty-icon name="loader" class="w-8 h-8 mx-auto mb-4 ty-text-neutral-mild animate-spin"></ty-icon>
                <p class="ty-text-neutral-mild">Initializing wizard...</p>
            </div>
        </div>
    </div>
</ty-modal>

<!-- Loading Modal -->
<ty-modal id="loading-modal" size="md">
    <div class="ty-elevated rounded-xl shadow-xl max-w-md mx-auto">
        <div class="p-8">
            <div class="flex items-center space-x-4 mb-6">
                <div id="loading-spinner" class="htmx-indicator">
                    <ty-icon name="loader" class="w-6 h-6 ty-text-info animate-spin"></ty-icon>
                </div>
                <h3 class="text-lg font-semibold ty-text-neutral-strong">Loading Content</h3>
            </div>
            <div id="loading-modal-content">
                <p class="ty-text-neutral-mild">Content will appear here...</p>
            </div>
        </div>
    </div>
</ty-modal>

<!-- Error Modal -->
<ty-modal id="error-modal" size="md" flavor="danger">
    <div class="ty-elevated rounded-xl shadow-xl max-w-md mx-auto">
        <div class="p-8">
            <h3 class="text-lg font-semibold ty-text-danger-strong mb-4">Error Demonstration</h3>
            <div id="error-modal-content">
                <p class="ty-text-neutral-mild">Error content will be loaded here...</p>
            </div>
            <div class="flex justify-end mt-6">
                <ty-button flavor="danger" onclick="document.getElementById('error-modal').removeAttribute('open')">
                    Close
                </ty-button>
            </div>
        </div>
    </div>
</ty-modal>

<!-- Parent Modal (for nesting demo) -->
<ty-modal id="parent-modal" size="md">
    <div class="ty-elevated rounded-xl shadow-xl max-w-md mx-auto">
        <div class="p-8 text-center">
            <h3 class="text-lg font-semibold ty-text-neutral-strong mb-4">Parent Modal</h3>
            <p class="ty-text-neutral-mild mb-6">
                This modal can open another modal, demonstrating modal layering capabilities.
            </p>
            <div class="flex justify-center space-x-3">
                <ty-button flavor="secondary" onclick="document.getElementById('parent-modal').removeAttribute('open')">
                    Close
                </ty-button>
                <ty-button flavor="primary" onclick="document.getElementById('child-modal').setAttribute('open', 'true')">
                    <ty-icon name="layers" class="mr-2"></ty-icon>
                    Open Child Modal
                </ty-button>
            </div>
        </div>
    </div>
</ty-modal>

<!-- Child Modal (nested) -->
<ty-modal id="child-modal" size="sm">
    <div class="ty-elevated rounded-xl shadow-xl max-w-sm mx-auto">
        <div class="p-6 text-center">
            <ty-icon name="layers" class="w-12 h-12 mx-auto mb-4 ty-text-secondary"></ty-icon>
            <h3 class="text-lg font-semibold ty-text-neutral-strong mb-2">Child Modal</h3>
            <p class="ty-text-neutral-mild mb-4">
                This modal opened from another modal, demonstrating layering.
            </p>
            <ty-button flavor="secondary" onclick="document.getElementById('child-modal').removeAttribute('open')">
                Close Child Modal
            </ty-button>
        </div>
    </div>
</ty-modal>

{% endblock %}

{% block extra_scripts %}
<script>
// Modal event listeners for debugging and enhanced functionality
document.addEventListener('ty-modal-open', function(event) {
    console.log('🔓 Modal opened:', event.target.id);
});

document.addEventListener('ty-modal-close', function(event) {
    console.log('🔒 Modal closed:', event.target.id, 'Reason:', event.detail?.reason);
});

// Enhanced HTMX loading for modals
document.body.addEventListener('htmx:beforeRequest', function(event) {
    const target = event.detail.target;
    if (target && target.closest('ty-modal')) {
        console.log('📡 Loading modal content...');
        // Add loading state if needed
    }
});

document.body.addEventListener('htmx:afterRequest', function(event) {
    const target = event.detail.target;
    if (target && target.closest('ty-modal')) {
        console.log('✅ Modal content loaded');
        // Remove loading state, add animations, etc.
        target.classList.add('animate-fade-in');
    }
});

// Handle HTMX errors in modals gracefully
document.body.addEventListener('htmx:responseError', function(event) {
    const target = event.detail.target;
    if (target && target.closest('ty-modal')) {
        console.error('❌ Error loading modal content:', event.detail.xhr.status);
        target.innerHTML = `
            <div class="p-8 text-center">
                <ty-icon name="alert-circle" class="w-12 h-12 mx-auto mb-4 ty-text-danger"></ty-icon>
                <h3 class="text-lg font-semibold ty-text-danger-strong mb-2">Error Loading Content</h3>
                <p class="ty-text-neutral-mild mb-4">
                    Failed to load content (${event.detail.xhr.status}). Please try again.
                </p>
                <ty-button flavor="danger" onclick="location.reload()">
                    <ty-icon name="refresh-cw" class="mr-2"></ty-icon>
                    Reload Page
                </ty-button>
            </div>
        `;
    }
});
</script>
{% endblock %}
